if(typeof convertHex!="function"){function convertHex(e,t){t=t==""?75:t;var i,r,f;e=e.replace("#","");t=t>1?t/100:t;i=parseInt(e.substring(0,2),16);r=parseInt(e.substring(2,4),16);f=parseInt(e.substring(4,6),16);return"rgba("+i+","+r+","+f+","+t+")"}}jQuery(document).ready(function(e){"use strict";function t(t,i){e.post(rfbwp_ajax,{action:"rfbwp_get_flipbook",rfbwp_id:t},function(e){i.append(e).find("li.fullscreen").remove();i.siblings(".rfbwp-close").addClass("rfbwp-show");d.trigger("rfbwp.shelf");setTimeout(function(){l.removeClass("rfbwp-animate rfbwp-swap");l.fadeOut(200);v=false;u=i.find(".flipbook");i.parent().css("overflow","hidden");setTimeout(function(){i.parent().css("overflow","")},250)},250)})}function i(t){var i=0,r=t.data.shelf.width()-t.data.books.length*20,f=200;t.data.books.each(function(){i+=parseFloat(e(this).attr("data-fb-r"))});f=f<Math.floor(r/i)?f:Math.floor(r/i);t.data.books.each(function(){var t=e(this);t.css({width:Math.floor(f*t.attr("data-fb-r")),height:f})});t.data.shelf.addClass("rfbwp-wrapped")}function r(e,t){l.css({top:e.offset().top-d.scrollTop(),left:e.offset().left,width:e.outerWidth(),height:e.outerHeight()});t.append(l);o()}function f(e){l.show();l.addClass("rfbwp-animate");l.css({top:e.offset().top-d.scrollTop(),left:e.offset().left,width:e.outerWidth(),height:e.outerHeight()});setTimeout(function(){l.remove()},250)}function o(){if(typeof b=="undefined")return;var e=d.width(),t=d.height(),i=parseInt(b.attr("data-fb-p")),r=parseInt(b.attr("data-fb-w"))*2+i*2,f=parseInt(b.attr("data-fb-h"))+i*2,o=b.is(".rfbwp-hard-cover"),s=b.is(".rfbwp-nav-top"),n=b.is(".rfbwp-nav-aside"),a=parseInt(b.attr("data-fb-n")),p,w,u;if(n&&!c)a=0;w=e-20-(o?20:0);u=t-60-a-(o?20:0)+(!n&&o?10:0);if(r>w){p=w/r;r=w>>0;f=f*p>>0}if(h){r*=2;f*=2}if(f>u){p=r/f;f=u>>0;r=u*p>>0}if(r%2==1)r-=1;if(o){r+=20;f+=20}l.addClass("rfbwp-animate");l.css({top:(u-f)/2+30+(o&&!n?10:0)+(s?a:0),left:(w-r/2)/2+10+(o?15:0),width:r/2,height:f})}function s(){if(u!=undefined)o()}function n(){clearTimeout(w);w=setTimeout(function(){d.trigger("rfbwp.smart_resize")},100)}var a=e(".rfbwp-shelf");if(!a.length)return;var d=e(window),p=e("html, body"),l,c=d.width()<=768,w,b,u,h,v,g=0;d.on("resize",n);a.each(function(){var o=e(this),n=o.find(".rfbwp-shelf-book"),a=o.find(".rfbwp-shelf-cache"),w=o.find(".rfbwp-shelf-box"),m=w.find(".rfbwp-close"),k=w.find(".rfbwp-shelf-wrap");o.prev(".rfbwp-shelf").addClass("rfbwp-stack");o.on("click",".rfbwp-shelf-book",function(i){i.preventDefault();var f=e(this),s=f.attr("data-fb-id"),n=f.attr("data-fb-fs").split("|");if(v)return;v=true;b=f;h=!!(k.width()*.5*1.25<parseInt(f.attr("data-fb-w"))&&k.width()<600);g=d.scrollTop();p.css({overflow:"hidden",position:"relative"});setTimeout(function(){p.css("height","100%")},1e3);l=e('<div class="rfbwp-scale"><div class="rfbwp-loader"><div class="rfbwp-circle-one"></div><div class="rfbwp-circle-two"></div></div><img src="'+f.find("img")[0].src+'"></div>');l.attr("style",f.attr("style"));if(f.is(".rfbwp-hard-cover"))l.addClass("rfbwp-hard-cover");if(e.isArray(n)){w.css({background:convertHex(n[0],n[1])});w.find(".rfbwp-close").attr("data-reverse",n[2])}else{w.removeAttr("style");w.find(".rfbwp-close").removeAttr("data-reverse")}w.addClass("rfbwp-active");r(b,o,k);setTimeout(function(){var e=a.find('.flipbook[data-fb-id="'+s+'"]').parent();if(e.length){e.appendTo(k);d.trigger("rfbwp.resize");v=false;u=e;setTimeout(function(){e.addClass("rfbwp-inited");l.fadeOut(200);m.addClass("rfbwp-show");w.css("overflow","hidden");setTimeout(function(){w.css("overflow","")},250)},250)}else{l.addClass("rfbwp-swap");t(s,k)}},250)});m.on("mousedown",function(e){e.preventDefault()});m.on("click",function(e){e.preventDefault();if(k.find(".flipbook").length){if(k.find("div.show-all").length){k.find("div.fb-nav").find(".show-all-close").trigger("click")}else if(k.find("div.zoomed").length){d.trigger("closeZoom")}else{if(v)return;v=true;p.css({overflow:"",position:"",height:""});setTimeout(function(){d.scrollTop(g)},10);k.find(".flipbook").trigger("rfbwp.close");m.removeClass("rfbwp-show")}}});d.on("rfbwp.closed",function(){if(b==undefined)return;if(b.parents(".rfbwp-shelf")[0]!=o[0])return;w.removeClass("rfbwp-active");f(b);b=undefined;u=undefined;k.find(".flipbook").parent().appendTo(a);setTimeout(function(){v=false},250)});d.on("rfbwp.smart_resize",function(){c=d.width()<=768;s()});i({data:{shelf:o,books:n}});d.on("rfbwp.smart_resize",{shelf:o,books:n},i)})});jQuery(document).ready(function(e){"use strict";function t(t,i){e.post(rfbwp_ajax,{action:"rfbwp_get_flipbook",rfbwp_id:t},function(e){l.remove();i.append(e);i.siblings(".rfbwp-close").addClass("rfbwp-show");f.trigger("rfbwp.shelf");setTimeout(function(){h=false},250)})}function i(){clearTimeout(w);w=setTimeout(function(){f.trigger("rfbwp.smart_resize")},100)}var r=e(".rfbwp-popup-book");if(!r.length)return;var f=e(window),o=e("html, body"),s=e(".rfbwp-popup"),n=s.find(".rfbwp-popup-cache"),a=s.find(".rfbwp-popup-box"),d=a.find(".rfbwp-close"),p=a.find(".rfbwp-popup-wrap"),l=e('<div class="rfbwp-loader"><div class="rfbwp-circle-one"></div><div class="rfbwp-circle-two"></div></div>'),c=f.width()<=768,w,b,u,h,v=0;f.on("resize",i);r.on("click",function(i){i.preventDefault();var r=e(this),s=r.attr("data-fb-id"),c=r.attr("data-fb-fs").split("|");if(h)return;h=true;b=r;u=!!(p.width()*.5*1.25<parseInt(r.attr("data-fb-w"))&&p.width()<600);v=f.scrollTop();o.css({overflow:"hidden",position:"relative"});setTimeout(function(){o.css("height","100%")},1e3);if(e.isArray(c)){a.css({background:convertHex(c[0],c[1])});a.find(".rfbwp-close").attr("data-reverse",c[2])}else{a.removeAttr("style");a.find(".rfbwp-close").removeAttr("data-reverse")}a.addClass("rfbwp-active");setTimeout(function(){var e=n.find('.flipbook[data-fb-id="'+s+'"]').parent();if(e.length){e.appendTo(p);f.trigger("rfbwp.resize");h=false;setTimeout(function(){e.addClass("rfbwp-inited");d.addClass("rfbwp-show")},250)}else{p.append(l);t(s,p)}},250)});d.on("mousedown",function(e){e.preventDefault()});d.on("click",function(e){e.preventDefault();if(p.find(".flipbook").length){if(p.find("div.show-all").length){p.find("div.fb-nav").find(".show-all-close").trigger("click")}else if(p.find("div.zoomed").length){f.trigger("closeZoom")}else{if(h)return;h=true;o.css({overflow:"",position:"",height:""});setTimeout(function(){f.scrollTop(v)},10);p.find(".flipbook").trigger("rfbwp.close");d.removeClass("rfbwp-show")}}});f.on("rfbwp.closed",function(){if(b==undefined)return;a.removeClass("rfbwp-active");b=undefined;p.find(".flipbook").parent().appendTo(n);setTimeout(function(){h=false},250)});f.on("rfbwp.popup",function(){r=e(".rfbwp-popup-book")});f.on("rfbwp.smart_resize",function(){c=f.width()<=768})});