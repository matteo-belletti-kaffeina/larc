(function(){var e=document.getElementsByTagName("HTML")[0];var i=navigator.userAgent.toLowerCase();i=i.indexOf("msie")!=-1?parseInt(i.split("msie")[1]):false;if(i==9)e.className+=" ie9"})();if(typeof convertHex!="function"){function convertHex(e,i){i=i==""?75:i;var t,a,s;e=e.replace("#","");i=i>1?i/100:i;t=parseInt(e.substring(0,2),16);a=parseInt(e.substring(2,4),16);s=parseInt(e.substring(4,6),16);return"rgba("+t+","+a+","+s+","+i+")"}}jQuery.extend(jQuery.easing,{easeOutExpo:function(e,i,t,a,s){return i==s?t+a:a*(-Math.pow(2,-10*i/s)+1)+t}});(function(e){var i=e(".rfbwp-shelf").length>0;var t=e(".rfbwp-popup-book").length>0;function a(a,s){var o=s.find(".flipbook.rfbwp-init").first();var d=e(".flipbook").length-1;if(o.length){i=e(".rfbwp-shelf").length>0;t=e(".rfbwp-popup-book").length>0;n(d,o);o.removeClass("rfbwp-init");o.parent().addClass("rfbwp-inited");e(window).trigger("rfbwp.refocus-flipbook")}}function s(){e(".flipbook.rfbwp-init").each(function(a){i=e(".rfbwp-shelf").length>0;t=e(".rfbwp-popup-book").length>0;var s=e(this);n(a,s);s.removeClass("rfbwp-init");s.parent().addClass("rfbwp-inited")})}function n(a,s){var n=[],o=3,d=2,r=2e3,f,l=true;var p=false,c=false,h="ontouchstart"in window,u=0,v=0,g="right",w=false,m=false,b=false,x=e(window),C=e("html, body");if(window["rfbwp_ie_8"]!=undefined)p=true;if(x.width()<=769)c=true;function y(){var e=I(),i,t=/^\d+$/;if(t.test(e)){i=e}else{i=0}return i}function k(){return window.location.href.split("#").shift()}function z(){return window.location.hash.slice(1)}function I(){var e=z(),i="fb"+a,t;if(e.indexOf(",")!=-1){e=e.split(",");for(var s=0;s<e.length;s++){if(e[s].search(i)!=-1)t=e[s].replace(i+"=","")}}else if(e!=""){if(e.indexOf(i)!=-1)t=e.replace(i+"=","");else t=0}else{t=0}return t}function _(e){var i=z(),t="fb"+a;if(i.indexOf(",")!=-1){i=i.split(",");for(var s=0;s<i.length;s++){if(i[s].search("fb"+a)!=-1)i[s]=t+"="+e}i=i.join(",")}else if(i!=""){if(i.indexOf(t)!=-1)i=t+"="+e;else i+=","+t+"="+e}else{i=t+"="+e}return i}function P(e){var a=e.turn("page"),s;if(a%2!=0)s=k()+"#"+_(a);else if(a==e.data().totalPages)s=k()+"#"+_(a);else s=k()+"#"+_(a+1);if(!i&&!t)window.location.href=s}function E(e,i){var t=I(),a=e.position();t=parseInt(t);if(t==0||t==e.turn("page")&&t!=e.data().totalPages)return;var s=e.siblings(".rfbwp-cover-wrap");if(s.length){if(t==e.data().totalPages){s.parent().attr("data-display","back")}else{s.parent().attr("data-display","inside");s.filter(".rfbwp-front").children(".rfbwp-cover").addClass("rfbwp-active")}if(t!=e.data().totalPages){s.addClass("rfbwp-both").removeClass("rfbwp-left");e.data().fauxCenter=true}if(!c)e.turn("updateOptions",{cornerSize:100})}if(e.data().opt.force_open)t=Math.max(Math.min(t,e.data().totalPages-1),3);b=true;if(t==e.data().totalPages){e.turn("page",t)}else if(t%2!=0){e.turn("page",t)}else{e.turn("page",t+1)}}function O(e){e.find("div.even div.fb-page").prepend('<div class="fb-inside-shadow-left"></div>');e.find("div.odd div.fb-page").prepend('<div class="fb-inside-shadow-right"></div>');e.find("div.last div.fb-page").prepend('<div class="fb-inside-shadow-left"></div>');e.find("div.first div.fb-page").prepend('<div class="fb-inside-shadow-right"></div>');e.find("div.even div.fb-page").prepend('<div class="fb-page-edge-shadow-left"></div>');e.find("div.odd div.fb-page").prepend('<div class="fb-page-edge-shadow-right"></div>');e.append('<div class="fb-shadow-bottom-left"></div>');e.append('<div class="fb-shadow-bottom-right"></div>');e.append('<div class="fb-shadow-top-left"></div>');e.append('<div class="fb-shadow-top-right"></div>')}function M(e,i,t,a,s){var n=t.turn("page"),o,d=false;if(d)return;if(!isNaN(s))d=true;if(e=="start"||d)o=t.activePageCorner();if(e=="start"&&o!="tl"&&o!="bl"&&o!="tr"&&o!="br"||d&&o!="tl"&&o!="bl"&&o!="tr"&&o!="br"){o=i}if(n+2>=t.data().totalPages&&(o=="right"||o=="tr"||o=="br")&&e!="start"){t.children("div.fb-shadow-top-right").css("opacity",0);t.children("div.fb-shadow-bottom-right").css("opacity",0)}else if(n<=3&&(o=="left"||o=="tl"||o=="bl")&&e!="start"){t.children("div.fb-shadow-top-left").css("opacity",0);t.children("div.fb-shadow-bottom-left").css("opacity",0)}t.children("div.fb-shadow-top-left").stop(true);t.children("div.fb-shadow-bottom-left").stop(true);t.children("div.fb-shadow-top-right").stop(true);t.children("div.fb-shadow-bottom-right").stop(true);if(n==2&&d&&(o=="tl"||o=="bl"||o=="left")){t.children("div.fb-shadow-top-left").animate({opacity:0},200);t.children("div.fb-shadow-bottom-left").animate({opacity:0},200)}else if(n==t.data().totalPages-2&&d&&(o=="tr"||o=="br"||o=="right")){t.children("div.fb-shadow-top-right").animate({opacity:0},200);t.children("div.fb-shadow-bottom-right").animate({opacity:0},200)}if(d)return;if(n==2&&(o=="tl"||o=="bl"||o=="left")){t.children("div.fb-shadow-top-left").animate({opacity:0},200);t.children("div.fb-shadow-bottom-left").animate({opacity:0},200)}else if(n!=1){t.children("div.fb-shadow-top-left").animate({opacity:1},500);t.children("div.fb-shadow-bottom-left").animate({opacity:1},500)}else{t.children("div.fb-shadow-top-left").animate({opacity:0},200);t.children("div.fb-shadow-bottom-left").animate({opacity:0},200)}if(n==t.data().totalPages-2&&(o=="tr"||o=="br"||o=="right")){t.children("div.fb-shadow-top-right").animate({opacity:0},200);t.children("div.fb-shadow-bottom-right").animate({opacity:0},200)}else if(n!=t.data().totalPages){t.children("div.fb-shadow-top-right").animate({opacity:1},500);t.children("div.fb-shadow-bottom-right").animate({opacity:1},500)}else{t.children("div.fb-shadow-top-right").animate({opacity:0},200);t.children("div.fb-shadow-bottom-right").animate({opacity:0},200)}}function S(){return Math.abs(window.orientation)==90}function T(e,i,t,a){var s=i.find(".fb-nav"),n=s.find(".main-nav"),o=s.find(".alternative-nav"),d;if(a=="zoom"){d=i.find(".show-previous, .show-next, .fb-zoom-out")}else if(a=="show-all"){d=i.find(".show-all-previous, .show-all-next, .show-all-close")}if(t=="exit"){D(o,d,i);H(e,n,i)}else{F(n,i);W(e,o,d,i,a)}var r=i.find(".fb-nav"),f=i.parent().is("#rfbwp_fullscreen, .rfbwp-shelf-wrap, .rfbwp-popup-wrap");if(t=="exit"){if(f&&r.hasClass("aside")&&!c)r.css("margin-top",-(r.height()*.5)-e.css("margin-top").replace("px",""));else if(r.hasClass("aside"))r.css("margin-top",-(r.height()*.5))}else{if(f&&r.hasClass("aside")&&!c)r.css("margin-top",-(r.find(".alternative-nav").height()*.75)-e.css("margin-top").replace("px",""));else if(r.hasClass("aside"))r.css("margin-top",-(r.find(".alternative-nav").height()*.75))}}function H(e,i,t){var a=e.turn("page"),s=e.data().totalPages,n=e.data().opt.force_open;i.css("visibility","visible");i.stop(true,true).animate({opacity:1},300);if(n){a=a-2<=1?1:a;a=a+2>=s?s:a}if(!e.data().fauxCenter||n){if(a==1){t.find(".preview").css("display","none");t.find(".next").css("display","inline-block");t.find(".next").stop(true,true).animate({opacity:1},300)}else if(a==s){t.find(".next").css("display","none");t.find(".preview").css("display","inline-block");t.find(".preview").stop(true,true).animate({opacity:1},300)}else{t.find(".preview, .next").css("display","inline-block");t.find(".preview, .next").stop(true,true).animate({opacity:1},300)}}else{t.find(".preview, .next").css("display","inline-block");t.find(".preview, .next").stop(true,true).animate({opacity:1},300)}}function F(i,t){i.stop(true,true).animate({opacity:0},300,function(){i.css("visibility","hidden")});t.find(".preview, .next").stop(true,true).animate({opacity:0},300,function(){e(this).css("display","none")})}function W(e,i,t,a,s){var n=e.turn("page"),o=e.data().totalPages,d=e.data().opt.force_open,r=a.find(".fb-nav").data("grouped");i.find("li").removeClass("active border-single").css({opacity:0});if(!r){if(s=="zoom")i.find(".fb-zoom-out").addClass("border-single");else i.find(".show-all-close").addClass("border-single")}t.addClass("active").stop(true,true).animate({opacity:1},300);if(s=="zoom"){if(d){n=n-2<=1?1:n;n=n+2>=o?o:n}if(n==1){a.find(".show-previous").removeClass("active");a.find(".show-next").addClass("active");a.find(".show-next").stop(true,true).animate({opacity:1},300)}else if(n==o){a.find(".show-next").removeClass("active");a.find(".show-previous").addClass("active");a.find(".show-previous").stop(true,true).animate({opacity:1},300)}else{a.find(".show-previous, .show-next").addClass("active");a.find(".show-previous, .show-next").stop(true,true).animate({opacity:1},300)}}i.css("visibility","visible");i.stop(true,true).animate({opacity:1},300)}function D(e,i){e.stop(true,true).animate({opacity:0},300,function(){e.css("visibility","hidden")});i.stop(true,true).animate({opacity:0},300,function(){i.removeClass("active")})}function j(i,t){i.find(".page-html *:not(.no-scale), .mpc-numeration-wrap span").each(function(){var i=e(this);if(typeof i.data("_scale")!="undefined"){var a=i.data("_scale");if(i.is("img"))i.css({width:a["width"]*t+"px","margin-top":a["margin-top"]*t+"px","margin-right":a["margin-right"]*t+"px","margin-bottom":a["margin-bottom"]*t+"px","margin-left":a["margin-left"]*t+"px","padding-top":a["padding-top"]*t+"px","padding-right":a["padding-right"]*t+"px","padding-bottom":a["padding-bottom"]*t+"px","padding-left":a["padding-left"]*t+"px"});else if(i.parent().hasClass("mpc-numeration-wrap"))i.css({"font-size":a["font-size"]*t+"px","line-height":a["line-height"]*t+"px","margin-top":a["margin-top"]*t+"px","margin-right":a["margin-right"]*t+"px","margin-bottom":a["margin-bottom"]*t+"px","margin-left":a["margin-left"]*t+"px","padding-top":a["padding-top"]*t+"px","padding-right":a["padding-right"]*t+"px","padding-bottom":a["padding-bottom"]*t+"px","padding-left":a["padding-left"]*t+"px","border-width":a["border-width"]*t+"px","border-radius":a["border-radius"]*t+"px"});else i.css({"font-size":a["font-size"]*t+"px","line-height":a["line-height"]*t+"px"})}})}function Y(e,i,t,a){if(!a.length){return}var s=e.turn("page"),n=(t.is(".top")?t.outerHeight():0)+(t.is(".spread.top")?30:0),o=t.is(".top")?parseInt(t.css("margin-top")):parseInt(e.css("margin-top")),d=e.width(),r=0;if((s==1||s==e.data().totalPages)&&!e.data().fauxCenter){r=Math.floor((i.width()-d*.5)*.5);if(s==1)r-=d*.5}else{r=Math.floor((i.width()-d)*.5)}if(w){if(s!=1&&s!=e.data().totalPages){r=i.width()-d-10}}a.css({width:Math.ceil(d*.5)+10,height:e.height()+20,top:c?o:-10,left:r+d*.5,marginTop:n});if(C.is(".ie9"))a.css("margin-top",o>10?o+n:10)}function N(i,t,a,s,n,o){var d,r,f=s.find(".rfbwp-cover-wrap").length,h=s.data("force-zoom"),v=s.parent().is("#rfbwp_fullscreen, .rfbwp-shelf-wrap, .rfbwp-popup-wrap"),g=s.find(".fb-nav");a.turn("size",Math.ceil(i),Math.ceil(t));setTimeout(function(){Y(a,s,g,s.find(".rfbwp-cover-wrap"))},250);d=i*.5;r=t;if(n){var m=false,b=s.find("div.zoomed"),x=parseInt(b.css("border-left-width")),C=s.offset(),y=C.top;if(b.find("img.bg-img").hasClass("zoom-large"))m=true;if(!m){b.find("img.bg-img").css({"margin-top":"0px",opacity:1});b.find("img.bg-img.zoom-large").css("opacity",0)}else{b.find("img.bg-img").css("display","none");b.find("img.bg-img.zoom-large").css({"margin-top":"0px",opacity:1,display:"block"})}b.children().css("margin-top",0);if(e(this).find("div.fb-page").hasClass("double")){b.addClass("double")}if(e(this).hasClass("odd")){b.addClass("odd")}var k=2,z=0;if(c){k=1;if(w){z=i*.5-x*2}else{z=i-x*2}b.width(z);if(z>u*.5||h){k=2}}else{b.width(i*.5*k-x*2)}b.height(t-x*2);var I,_;if(c){_=u*.5*k-x*2;I=o*k-x*2}else{I=(a.height()-x*2)*k}b.find(" > div, > a.fb-container, div.video").each(function(){var i=e(this);if(b.hasClass("double"))i.width(c?_*2:"200%");else i.width(c?_:"100%");i.height(I)});var P=k;if(!c){P=t/o*k*.999}j(b,P);s.find("div.zoomed.double.odd img.bg-img").css("margin-left","0px");s.find("div.zoomed.double img.bg-img").css({left:"0px",right:"0px"});var E=0;if(g.hasClass("top")){E=parseInt(g.outerHeight());E=g.hasClass("spread")?E+30:E}b.css({left:(s.width()-b.outerWidth())*.5,top:E});s.find("div.zoomed-shadow").css({left:parseInt(b.css("left"))+x,top:parseInt(b.css("top"))+x+E,width:b.css("width")-20,height:b.css("height")-20});s.find("div.zoomed-shadow-top").css({left:parseInt(b.css("left"))+x+E,width:b.css("width")});s.find("div.zoomed-shadow-bottom").css({top:b.height()-40+x*2+E+(f?10:0),left:parseInt(b.css("left"))+x+E,width:b.css("width")});b.trigger("swapResponsive")}a.find("div.fb-page-content").each(function(){var i=e(this);i.width(d-parseInt(i.css("margin-top")));i.height(r-parseInt(i.css("margin-top"))*2);if(i.find("object, iframe").length)i.find(".preview-content").height("100%");if(i.parent().hasClass("double")){if(i.parent().parent().parent().hasClass("odd")){var t=parseInt(i.css("margin-right"));i.find("img.bg-img").css("margin-left",-i.width()+"px");i.find(".fb-container img.bg-img").css("margin-left","0px")}}i.parent().find("div.fb-inside-shadow-left").height(i.height());i.parent().find("div.fb-inside-shadow-right").height(i.height());i.parent().find("div.fb-page-edge-shadow-left").height(i.height());i.parent().find("div.fb-page-edge-shadow-right").height(i.height())});a.find("div.fb-shadow-bottom-left").width(i*.5);a.find("div.fb-shadow-bottom-right").width(i*.5);a.find("div.fb-shadow-top-left").width(i*.5);a.find("div.fb-shadow-top-right").width(i*.5);if(p&&!l)s.find("div.preview, div.next").css("top",a.find("div.turn-page-wrapper.first").height()-g.outerHeight());else if(g.hasClass("aside"))s.find("div.preview, div.next").css("top",(a.find("div.turn-page-wrapper.first").height()-g.find(".main-nav li").outerHeight())*.5);else s.find("div.preview, div.next").css("top",(a.find("div.turn-page-wrapper.first").height()-g.outerHeight())*.5)}function R(e,i,t,a){if(!w)return;var s=i.data().done,n=i.width(),o=n*.5,d=0,r=t.find(".rfbwp-cover-wrap").length,f={duration:!s?0:600,easing:"easeOutExpo",complete:function(){i.turn("resize")}};i.stop(true);if(a=="left"||e==1){d=Math.floor((t.width()-o)*.5)-o}else{d=Math.floor((t.width()-o)*.5)}if(r)t.find(".rfbwp-front, .rfbwp-back").animate({left:d+o},f);if(parseInt(i.css("left"))!=d)i.animate({left:d},f)}function q(e,i,t,a){var s=i.data().done,n=i.width(),o=n*.5,d=Math.floor((t.width()-o)*.5),r=t.find(".rfbwp-cover-wrap").length,f=t.find(".fb-page-content").hasClass("zoomed"),h={duration:!s?0:600,easing:"easeOutExpo"};if(r&&!i.data().fauxCenter)t.find("li.zoom").css("display","none");else t.find("li.zoom").css("display","inline-block");i.stop(true,true);if(m){m=false;h.duration=0}if(w){if(g=="right"||e==1)d-=o;if(parseInt(i.css("left"))!=d){i.stop(true).animate({left:d},h);M("center",a,i,t,Math.floor((t.width()-o)*.5)-o)}if(t.find(".rfbwp-front, .rfbwp-back").length)t.find(".rfbwp-front, .rfbwp-back").css({left:d+o})}else{if(i.data().fauxCenter){if(e==1)e=2;else if(e==i.data().totalPages)e=i.data().totalPages-1}if(e==1||e==i.data().totalPages){if(e==1)d-=o;if(parseInt(i.css("left"))!=d){i.stop(true).animate({left:d},h);M("center",a,i,t,Math.floor((t.width()-o)*.5)-o)}}else{d=Math.floor((t.width()-n)*.5);if(parseInt(i.css("left"))!=d)i.stop(true).animate({left:d},h);M("center",a,i,t,Math.floor((t.width()-n)*.5))}if(t.find(".rfbwp-front, .rfbwp-back").length)t.find(".rfbwp-front, .rfbwp-back").stop(true).animate({left:d+o},h)}var u,v,b,x;if(p&&!l){u=d+n;v=d;b=d+n;x=d}else{u=d+n;v=d;b=d+n;x=d}var C=t.find(".fb-nav").hasClass("spread")?Math.floor(t.find("div.preview").outerWidth()*.33)+28:8,y=i.data().totalPages,k=i.data().opt.force_open;if(k){e=e-2<1?1:e;e=e+2>=y?y:e}C=t.hasClass("nav-with-cover")?C+10:C;if(e==1&&!i.data().fauxCenter||e<=3&&k){t.find(".preview, .show-previous").css({opacity:0});t.find(".preview").css({display:"none"});t.find(".show-previous").removeClass("active");t.find("div.preview").stop(true,true).animate({left:x-t.find("div.preview").outerWidth()+Math.floor(t.find("div.preview").outerWidth()*.33)-C},300,"easeOutExpo")}else{t.find("div.preview").stop(true,true).animate({left:v-t.find("div.preview").outerWidth()+Math.floor(t.find("div.preview").outerWidth()*.33)-C},300,"easeOutExpo");if(!f)t.find(".preview").css({display:"inline-block"}).animate({opacity:1},300,"easeOutExpo");if(f)t.find(".show-previous").addClass("active").css({opacity:1})}if(e==y){t.find(".next, .show-next").css({opacity:0});t.find(".next").css({display:"none"});t.find(".show-next").removeClass("active");t.find("div.next").stop(true,true).animate({left:b-Math.floor(t.find("div.next").outerWidth()*.33)+C},300,"easeOutExpo")}else{t.find("div.next").stop(true,true).animate({left:u-Math.floor(t.find("div.next").outerWidth()*.33)+C+"px"},300,"easeOutExpo");if(!f)t.find(".next").css({display:"inline-block"}).animate({opacity:1},300,"easeOutExpo");if(f)t.find(".show-next").addClass("active").css({opacity:1})}var z=t.find(".fb-nav"),I=t.parent().is("#rfbwp_fullscreen, .rfbwp-shelf-wrap, .rfbwp-popup-wrap");if(I&&z.hasClass("aside")&&!c)z.css("margin-top",-(z.height()*.5));else if(z.hasClass("aside"))z.css("margin-top",-(z.height()*.5))}function A(i,t){x.trigger("rfbwp.resize");M("turned","false",i,t,"first run");t.find(".fb-nav").animate({opacity:1},1e3,"easeOutExpo");i.parent().css("background-image","none");i.find(".bg-img").css("visibility","visible");if(p){e(".page-transition").parent().addClass("page-transitions");i.turn("disable")}}function L(e){e.find("div.fb-shadow-bottom-left").stop(true).css("opacity",0);e.find("div.fb-shadow-top-left").stop(true).css("opacity",0);e.find("div.fb-shadow-bottom-right").stop(true).css("opacity",0);e.find("div.fb-shadow-top-right").stop(true).css("opacity",0)}function X(a){var s=a,n=s.parent(),r=n.find("div.fb-nav"),h=n.find(".fb-zoom-out"),z=e('<div id="rfbwp_fullscreen">'),I=n.parent(),S=false,H=false,F=false,W="false",D=0,X,B,Q=false,Z=false,K=false,U="ontouchstart"in window,$,G,J,V,ee=false,ie=true,te=n.data("turn-sound"),ae=n.data("force-zoom"),se=n.is(".is-rtl");if(te){e.ionSound({sounds:[{name:"turn"}],volume:.3,path:mpcthLocalize.soundsPath,preload:true})}z.on("touchmove",function(e){e.preventDefault()});o=parseInt(r.find(".toc").attr("data-toc-index"));s.on("click",".toc a",function(a){a.preventDefault();var n=e(this).data("page"),o=k()+"#"+_(n);if(!i&&!t)window.location.href=o;else s.turn("page",n)});if(p)n.addClass("ie_fallback");if(s.is(".no-arrows"))l=false;n.after(z);s.on("faux-turning",function(e,i){q(i,s,n,W)});s.on("turning",function(i,t){if(t==1){s.children("div.fb-shadow-top-left").addClass("force-hide");s.children("div.fb-shadow-bottom-left").addClass("force-hide")}else{s.children("div.fb-shadow-top-left").removeClass("force-hide");s.children("div.fb-shadow-bottom-left").removeClass("force-hide")}if(t==s.data().totalPages){s.children("div.fb-shadow-top-right").addClass("force-hide");s.children("div.fb-shadow-bottom-right").addClass("force-hide")}else{s.children("div.fb-shadow-top-right").removeClass("force-hide");s.children("div.fb-shadow-bottom-right").removeClass("force-hide")}K=true;q(t,s,n,W);if(!H&&te){e.ionSound.stop("turn");e.ionSound.play("turn")}});s.on("turned",function(i,t){var a=e(this);var o=a.data().done;if(!b){if(t%2)g="right";else g="left"}b=false;if(S){f=setTimeout(function(){a.turn("next");if(s.turn("page")+2>=s.data().totalPages){S=false;r.find("ul li.slideshow").removeClass("active");if(J){setTimeout(function(){Me.click()},de)}M("start","right",s,n,"end")}},de)}M("turned","false",s,n,"end");K=false});s.find("div.fb-page").each(function(){var i=e(this);if(i.hasClass("double")){var t=i.clone(true);if(t.find(".mpc-numeration-wrap").data("page-number")!==undefined){var a=t.find(".mpc-numeration-wrap").data("page-number");if(se){t.find(".mpc-numeration-wrap").attr("data-page-number",a).find("span").text(a);a++;i.find(".mpc-numeration-wrap").attr("data-page-number",a).find("span").text(a)}else{a++;t.find(".mpc-numeration-wrap").attr("data-page-number",a).find("span").text(a)}}t.insertAfter(i)}});$=parseInt(y());if($==0){if(se){$=s.find("div.fb-page").length}else{$=1}}V=n.attr("data-force-open")==1;s.turn({page:$,acceleration:true,shadows:!e.isTouch,duration:p?0:500,cornerSize:p?0:100,force_open:V});if(p)s.turn("updatePageOptions",{cornerSize:0});s.find("div.turn-page-wrapper").each(function(){var i=e(this),t=e(this).attr("page"),a=s.data().totalPages,n;if(t==1){i.addClass("first");i.find("div.fb-page-content").addClass("first")}else if(t==a){i.addClass("last");i.find("div.fb-page-content").addClass("last")}else if(t%2==0){i.addClass("even");i.find("div.fb-page-content").addClass("even")}else{i.addClass("odd");i.find("div.fb-page-content").addClass("odd")}if(t%2!=0&&t!=1&&t!=a){var o=parseInt(i.find("div.double div.fb-page-content").css("margin-right"));i.find("div.double div.fb-page-content img.bg-img").css("margin-left",-i.width()+o+"px");i.find(".fb-container img.bg-img").css("margin-left","0px")}});s.find(" > div:last-child > div").each(function(){var i=e(this);D++;X=s.data().totalPages;i.addClass("page-transition");i.attr("page",D);if(D==1)i.addClass("first");else if(D==X)i.addClass("last");else if(D%2==0)i.addClass("even");else i.addClass("odd")});var ne=s.find("div.turn-page-wrapper > div").width(),oe=s.find("div.turn-page-wrapper > div").height();s.find("div.turn-page-wrapper").dblclick(function(i){var t=d,a,o,l,m,b=false,C=e(this),y=r.data("grouped");if(H){return}if(p)s.turn("updateOptions",{duration:500});if(S){S=!S;clearTimeout(f);r.find("ul li.slideshow").removeClass("active")}a=C.find("div.fb-page-content").clone(true).addClass("zoomed");a.append('<div class="rfbwp-loader"><div class="rfbwp-circle-one"></div><div class="rfbwp-circle-two"></div></div>');s.parent().prepend(a).css("opacity",0).animate({opacity:1},500);a.find(".toc a").on("click",function(e){e.preventDefault()});if(!p)s.parent().prepend('<div class="zoomed-shadow"></div>').css("opacity",0).animate({opacity:1},500);var k=n.find(".big-side.show-previous");var z=n.find(".big-side.show-next");if(!z.length){var I=r.data("prev-icon").length?r.data("prev-icon"):"icon-left-open",_=r.data("next-icon").length?r.data("next-icon"):"icon-right-open",P=r.hasClass("spread")?"spread":"";if(y||e(window).width()<=1024){k=e('<li class="big-side show-previous"><i class="'+I+'"></i></li>');z=e('<li class="big-side show-next"><i class="'+_+'"></i></li>');r.find(".alternative-nav").prepend(k);r.find(".alternative-nav").append(z)}else{k=e('<div class="big-side show-previous '+P+'"><i class="'+I+'"></i></div>');z=e('<div class="big-side show-next '+P+'"><i class="'+_+'"></i></div>');n.append(k);n.append(z)}}else{k.off("click");z.off("click")}var E=r.find("ul li[data-text]");if(E.length){var O=0;E.each(function(){var i=e(this);if(O<i.width())O=i.width()});n.find(".big-side").width(O).height(O).css("line-height",O+"px")}e(window).width()<=1024?be(n):xe(n);k.on("click",function(e){e.preventDefault()});z.on("click",function(e){e.preventDefault()});k.one("click",function(e){G=C.prev();if(w){var i=G.prev();if(a.is(".double.even")&&G.find(".fb-page.double")){if(i.length){G=i}}else if(a.is(".double.odd")&&i.find(".fb-page.double")){i=i.prev();if(i.length){G=i}}else if(a.is(":not(.double)")&&G.find(".fb-page.double")){if(i.length){G=i}}}de();if(G.css("z-index")!=C.css("z-index")){s.turn("updateOptions",{block_swipe:false});s.turn("updateOptions",{duration:0});s.on("turned",F);s.turn("previous");s.turn("updateOptions",{duration:600})}else{G.dblclick()}});z.one("click",function(e){G=C.next();if(w&&a.is(".double.even")){var i=G.next();if(i.length){G=i}}de();if(G.css("z-index")!=C.css("z-index")){s.turn("updateOptions",{block_swipe:false});s.turn("updateOptions",{duration:0});s.on("turned",F);s.turn("next");s.turn("updateOptions",{duration:600})}else{G.dblclick()}});function F(e,i){s.off("turned",F);G.dblclick()}s.animate({opacity:0},500,function(){s.css({visibility:"hidden","pointer-events":"none"})});if(J){if(s.turn("page")==1&&!s.data().fauxCenter){Oe.click()}else if(s.turn("page")==s.data().totalPages&&!s.data().fauxCenter){Me.click()}else if(!s.data().fauxCenter){Oe.click()}Ee.animate({opacity:0},250,function(){Ee.css("visibility","hidden")});a.css("margin-top",10)}n.find("div.next:not(.zoom), div.preview:not(.zoom)").stop(true).fadeOut(300);if(!p)s.parent().prepend('<div class="zoomed-shadow-top"></div><div class="zoomed-shadow-bottom"></div>');l=parseInt(a.css("border-left-width"));var W=n.offset();o=W.top;if(i.pageY==undefined)i.pageY=o;if(!c)a.children(":not(.rfbwp-loader)").css("margin-top",o-i.pageY);var D=a.find("img.bg-img.zoom-large");if(D.length){b=true;if(D.attr("src")!=D.attr("data-src"))D.attr("src",D.attr("data-src"))}if(!b){a.find("img.bg-img").css({"margin-top":"0px",opacity:1});a.find("img.bg-img.zoom-large").css("opacity",0)}else{a.find("img.bg-img").css("display","none");a.find("img.bg-img.zoom-large").css({"margin-top":"0px",opacity:1,display:"block"})}a.children(".rfbwp-loader").remove();if(e(this).find("div.fb-page").hasClass("double")){a.addClass("double")}if(e(this).hasClass("odd")){a.addClass("odd")}var Y=a.find(".mpc-numeration-wrap");if(c&&a.is(".double")&&Y.length){var N;if(a.is(".even")){N=C.next().find(".mpc-numeration-wrap").clone(true).addClass("force-right");Y.addClass("force-left")}else{N=C.prev().find(".mpc-numeration-wrap").clone(true).addClass("force-left");Y.addClass("force-right")}a.find(".mpc-numeration-wrap").after(N)}var R=t,q=0;if(c){R=1;if(w){q=s.width()*.5-l*2}else{q=s.width()-l*2}a.width(q);if(q>u*.5||ae){R=2}}else{a.width(s.width()*.5*R-l*2)}a.height(s.height()-l*2);var A,L;if(c){L=u*.5*R-l*2;A=v*R-l*2}else{A=(s.height()-l*2)*R}a.find(" > div, > a.fb-container, div.video").each(function(){var i=e(this);if(a.hasClass("double"))i.width(c?L*2:"200%");else i.width(c?L:"100%");i.height(A)});var X=0;if(c){X=R}else{X=s.height()/v*R*.999}j(a,X);n.find("div.zoomed.double.odd img.bg-img").css("margin-left","0px");n.find("div.zoomed.double img.bg-img").css({left:"0px",right:"0px"});if(!H)T(s,n,"show","zoom");H=true;var B="";if(r.hasClass("top")){B=r.outerHeight();B=r.hasClass("spread")?B+30:B}a.css({left:(n.width()-a.outerWidth())*.5,top:B});n.find("div.zoomed-shadow").css("left",parseInt(a.css("left"))+l);n.find("div.zoomed-shadow").css("top",parseInt(a.css("top"))+l+B);n.find("div.zoomed-shadow").css("width",a.css("width")-l*2);n.find("div.zoomed-shadow").css("height",a.css("height")-l*2);var Q=parseInt(a.css("left").replace("px","")),Z=Q+parseInt(a.outerWidth()),K=n.find("div.show-previous"),$=n.find("div.show-next"),ee=n.find(".fb-nav").hasClass("spread")?K.outerWidth()*.33+20:8;ee=n.hasClass("nav-with-cover")?ee+10:ee;K.css({left:Q-K.outerWidth()-ee,"margin-top":-(K.outerHeight()*(p?1:.5))});$.css({left:Z+ee,"margin-top":-($.outerHeight()*(p?1:.5))});var ie=s.turn("page"),te=s.data().totalPages;if(V){ie=ie-2<=1?1:ie;ie=ie+2>=te?te:ie}if(ie==1){n.find(".show-previous").removeClass("active");n.find(".show-next").addClass("active");n.find(".show-next").stop(true,true).animate({opacity:1},300)}else if(ie==te){n.find(".show-next").removeClass("active");n.find(".show-previous").addClass("active");n.find(".show-previous").stop(true,true).animate({opacity:1},300)}else{n.find(".show-previous, .show-next").addClass("active");n.find(".show-previous, .show-next").stop(true,true).animate({opacity:1},300)}h.on("click",oe);var se=a.outerHeight(),ne=parseInt(a.css("left"));if(!c&&U){a.addSwipeEvents().on("doubletap",function(e,i){oe()}).on("swipeleft",function(){if(!C.is(".last"))z.click()}).on("swiperight",function(){if(!C.is(".first"))k.click()})}a.addSwipeEvents().on("doubletap",function(e,i){setTimeout(function(){if(H){oe()}},10)});a.dblclick(function(){oe()});x.on("closeZoom",oe);function oe(){if(!H){return}if(p)s.turn("updateOptions",{duration:0});s.css({visibility:"visible","pointer-events":"all"});s.stop(true).animate({opacity:1},300,function(){M("turned","false",s,n,"zoom")});if(J)Ee.css("visibility","visible").stop(true).animate({opacity:1},300);s.turn("updateOptions",{block_swipe:false});a.animate({opacity:0},300,function(){e(this).remove();H=false;r.find("ul li.zoom").trigger("mouseout")});T(s,n,"exit","zoom");h.off("click",oe);n.find("div.zoomed-shadow").stop(true).animate({opacity:0},300,function(){e(this).remove()});n.find("div.zoomed-shadow-bottom").stop(true).animate({opacity:0},100,function(){e(this).remove()});n.find("div.zoomed-shadow-top").stop(true).animate({opacity:0},100,function(){e(this).remove()})}function de(){H=false;n.find("div.zoomed-shadow").stop(true).animate({opacity:0},300,function(){e(this).remove()});n.find("div.zoomed-shadow-bottom").stop(true).animate({opacity:0},100,function(){e(this).remove()});n.find("div.zoomed-shadow-top").stop(true).animate({opacity:0},100,function(){e(this).remove()});n.find("div.fb-page-content.zoomed").animate({opacity:0},100,function(){e(this).remove()})}if(U||w){a.addClass("wide-view");if(g=="right"){a.scrollLeft(L)}}a.find(" > div, > a.fb-container").css("position","relative");a.find("img.bg-img").css("left","0px");if(!c&&!U){a.on("mousemove touchmove",function(e){var i=a.height(),t=a.children().height(),s=e.type=="touchmove"?e.originalEvent.touches[0].pageY:e.pageY;var n=(-t+i)/-i,d=0;if((o-s)*n>-t+i)d=(o-s)*n;else d=-t+i;d=Math.max(Math.min(d,0),i-t);a.find("> div, > a.fb-container").css("margin-top",d)})}else{s.turn("updateOptions",{block_swipe:true})}m=a.position();n.find("div.zoomed-shadow-top, div.zoomed-shadow-bottom").width(a.width()).animate({opacity:1},500);n.find("div.zoomed-shadow-top").css({top:m.top-15+(J?10:0),left:m.left+l});n.find("div.zoomed-shadow-bottom").css({top:m.top+a.height()-40+2*l+(J?10:0),left:m.left+l});if(c){a.addClass("is-mobile")}a.on("swapResponsive",function(){var e=a.is(".is-mobile");if(c&&!e||!c&&e){G=C;de();G.dblclick()}})});s.find("div.turn-page-wrapper").addSwipeEvents().on("doubletap",function(i,t){var a=e(this);setTimeout(function(){if(!H){a.trigger("dblclick")}},10)});var de=n.data("slide-delay")?parseInt(n.data("slide-delay")):2e3,re=0;var fe=r.data("menu-type"),le=r.data("grouped"),pe=r.data("prev-icon"),ce=r.data("next-icon"),he="";if(le)he={prev:'<li class="preview'+(!l?" hidden":"")+'" data-icon="'+pe+'"></li>',next:'<li class="next'+(!l?" hidden":"")+'" data-icon="'+ce+'"></li>'};else he='<div class="next round'+(!l?" hidden":"")+" "+fe+'"><i class="'+ce+'"></i></div><div class="preview round'+(!l?" hidden":"")+" "+fe+'"><i class="'+pe+'"></i></div>';if(l||p)if(le){r.find(".main-nav").prepend(he.prev).append(he.next)}else{n.append(he)}if(r.hasClass("mobile"))n.find(".next, .preview").addClass("mobile");r.find("ul li").each(function(){var i=e(this);if(i.data("icon")){var t=i.data("icon"),a=i.data("icon-active");if(t.length==0){if(i.hasClass("slideshow"))i.append('<i class="icon-play"></i><i class="icon-pause"></i>');else if(i.hasClass("toc"))i.append('<i class="icon-list"></i>');else if(i.hasClass("zoom"))i.append('<i class="icon-search"></i>');else if(i.hasClass("show-all"))i.append('<i class="icon-layout"></i>');else if(i.hasClass("fullscreen"))i.append('<i class="icon-resize-full"></i><i class="icon-resize-small"></i>')}else{i.append('<i class="'+t+'"></i>')}if(a&&a.length>0){i.append('<i class="'+a+'"></i>')}}else if(i.data("text")){var s=i.data("text"),n=i.data("text-active");i.append('<i class="text">'+s+"</i>");if(n&&n.length>0){i.append('<i class="text">'+n+"</i>")}}});var ue=r.find("ul li[data-text]");if(ue.length){var ve=0;ue.each(function(){var i=e(this);if(ve<i.width())ve=i.width()});ue.width(ve).height(ve).css("line-height",ve+"px");n.find(".next, .preview, .show-next, .show-previous, .show-all-next, .show-all-previous").width(ve).height(ve).css("line-height",ve+"px")}if(se){o=s.data().totalPages-o+1}r.find("ul li.toc").on("click",function(e){if(s.turn("page")!=o)s.trigger("mouseover");if(J&&!s.data().fauxCenter){if(Oe.parent().is(".rfbwp-left"))Oe.click();else Me.click();setTimeout(function(){s.turn("page",o);L(s)},300)}else{s.turn("page",o);L(s)}});function ge(){if(!document.fullscreenElement&&!document.mozFullScreenElement&&!document.webkitFullscreenElement&&!document.msFullscreenElement){if(document.documentElement.requestFullscreen){document.documentElement.requestFullscreen();

}else if(document.documentElement.msRequestFullscreen){document.documentElement.msRequestFullscreen()}else if(document.documentElement.mozRequestFullScreen){document.documentElement.mozRequestFullScreen()}else if(document.documentElement.webkitRequestFullscreen){document.documentElement.webkitRequestFullscreen(Element.ALLOW_KEYBOARD_INPUT)}}else{if(document.exitFullscreen){document.exitFullscreen()}else if(document.msExitFullscreen){document.msExitFullscreen()}else if(document.mozCancelFullScreen){document.mozCancelFullScreen()}else if(document.webkitExitFullscreen){document.webkitExitFullscreen()}}}r.find("ul li.fullscreen").on("click",function(i){ge();var t=e(this),a=n.siblings(".fb-spacer").length?n.siblings(".fb-spacer"):n.before('<div class="fb-spacer"></div>').siblings(".fb-spacer");t.toggleClass("active");F=!F;m=true;if(F){var s=n.data("fullscreen").split("|");a.css({width:n.outerWidth(),height:n.outerHeight()});if(e.isArray(s)){z.css({background:convertHex(s[0],s[1])});z.find(".rfbwp-close").attr("data-reverse",s[2])}else{z.removeAttr("style");z.find(".rfbwp-close").removeAttr("data-reverse")}z.show();a.show();z.append(n);C.css("overflow","hidden");x.trigger("rfbwp.resize")}else{n.insertBefore(z);n.siblings(".fb-spacer").remove();z.hide();C.css("overflow","");x.trigger("rfbwp.resize")}});x.on("keydown",function(e){if(e.keyCode==27&&F){r.find("ul li.fullscreen").click()}});r.find("ul li.download").on("click",function(i){var t=e(this),a=t.attr("data-file");if(!a.length>0)return;window.location.href=mpcthLocalize.downloadPath+a});r.find("ul li.zoom").on("click",function(e){if(H){n.find(".fb-page-content.zoomed").trigger("dblclick")}else{var i=s.turn("page");if(se&&i<s.data().totalPages&&i!=1){i++}s.find(".turn-page-wrapper[page="+i+"]").trigger("dblclick")}});r.find("ul li.slideshow").on("click",function(i){if(s.turn("page")==s.data().totalPages)return;var t=e(this);t.toggleClass("active");S=!S;if(S){if(J&&!s.data().fauxCenter){Oe.click();setTimeout(function(){clearTimeout(f);s.turn("next")},de)}else{clearTimeout(f);s.turn("next")}}else{clearTimeout(f)}M("start","right",s,n,"end")});r.find("ul li.show-all").on("click",function(i){var t=s.height(),a=s.width()*(w?.5:1),o=12,d,f,l,p,c=6,h=1,g=10,m,b,C,y,k=parseInt(e(this).attr("data-cols")),z=r.data("grouped"),I;ee=true;if(isNaN(k)||k==0)k=2;else k*=2;var _=parseInt(s.find(".fb-page-content").css("margin-top"));y=(u-2*_)*.5/(v-_);s.turn("stop");n.append('<div class="show-all"><div class="content"></div><div class="rfbwp-trim-top"></div><div class="rfbwp-trim-bottom"></div></div>');n.append('<div class="showall-shadow-top"></div><div class="showall-shadow-bottom"></div>');var P=n.find("div.show-all"),E=n.find(".show-all-next, .show-all-previous").length,O=r.data("up-icon")?r.data("up-icon"):"fa fa-chevron-up",M=r.data("down-icon")?r.data("down-icon"):"fa fa-chevron-down",S=r.hasClass("spread")?"spread":"";if(!E&&z){r.find(".alternative-nav").append('<li class="big-next show-all-next"><i class="'+M+'"></i></li>');r.find(".alternative-nav").prepend('<li class="big-next show-all-previous"><i class="'+O+'"></i></li>')}else if(!E){n.append('<div class="big-next show-all-next '+S+'"><i class="'+M+'"></i></div>');n.append('<div class="big-next show-all-previous '+S+'"><i class="'+O+'"></i></div>')}var H=r.find("ul li[data-text]");if(H.length){var F=0;H.each(function(){var i=e(this);if(F<i.width())F=i.width()});n.find(".big-next").width(F).height(F).css("line-height",F+"px")}e(window).width()<=1024?be(n):xe(n);var W=s.find("div.fb-page-content");if(se){W=e(W.get().reverse())}W.each(function(){var i=e(this);if(!i.parent().parent().hasClass("fpage")){m=i.clone(true).addClass("show-all-thumb");m.find("img.bg-img.zoom-large").remove();m.attr("style","");if(i.parent().parent().parent().hasClass("last"))m.addClass("even");else if(i.parent().parent().parent().hasClass("first"))m.addClass("odd");if(i.parent().hasClass("double"))m.addClass("double");if(i.parent().parent().parent().hasClass("last")||i.parent().parent().parent().hasClass("first")&&se)P.find("div.content").prepend(m);else P.find("div.content").append(m)}});o=parseInt(P.find("div.content").css("top"));d=parseInt(P.find("div.show-all-thumb").css("margin-bottom"));f=parseInt(P.find("div.show-all-thumb.odd").css("margin-right"));l=parseInt(P.find("div.show-all-thumb").css("height"));p=parseInt(P.find("div.show-all-thumb").css("width"));b=l/t;var D=(a-o*2-f*(k/2-1))/k>>0,Y=D/y>>0;P.find("div.show-all-thumb").css({width:D,height:Y});while(n.height()<=o*2+c*(Y+d)-d){c--}var N=P.find("div.show-all-thumb").length;c=Math.min(Math.ceil(N/g),c);C=Y*c+o*2+d*c-d;P.width(a).height(C);if(P.height()>P.find(".content").height())n.find(".show-all-previous, .show-all-next").removeClass("active");else n.find(".show-all-previous, .show-all-next").addClass("active");I=(n.height()-P.outerHeight()-(r.hasClass("aside")?0:r.height()))*.5;P.css("top",I);g=k;h=1;var R=Y/(v-_*2);R*=1.04;P.find("div.show-all-thumb").each(function(){var i=e(this);if(h%g==0)i.addClass("last-thumb");h++;j(i,R);i.prepend('<span class="shadow"></span>');i.find("div.video").remove()});s.animate({opacity:0},500,function(){s.css("visibility","hidden")});if(J)Ee.animate({opacity:0},500,function(){Ee.css("visibility","hidden")});s.css("pointer-events","none");P.animate({opacity:1},500);P.css({left:(n.width()-P.width())*.5+"px"});var A=parseInt(P.css("left").replace("px","")),X=A+parseInt(P.outerWidth()),B=n.find("div.show-all-previous"),Q=n.find("div.show-all-next"),Z=n.find(".fb-nav").hasClass("spread")?B.outerWidth()*.33+20:0;Z=n.hasClass("nav-with-cover")?Z+10:Z;B.css({left:A-B.outerWidth()-Z,"margin-top":-B.outerHeight()*.5});Q.css({left:X+Z,"margin-top":-Q.outerHeight()*.5});T(s,n,"show","show-all");P.find("div.show-all-thumb").hover(function(){var i=e(this);i.find("span.shadow");i.find("span.shadow").stop(true).animate({opacity:.5},300);var t=se?i.next():i.prev(),a=se?i.prev():i.next();if(i.hasClass("even")){a.find("span.shadow");a.find("span.shadow").stop(true).animate({opacity:.5},300)}else{t.find("span.shadow");t.find("span.shadow").stop(true).animate({opacity:.5},300)}},function(){var i=e(this);i.find("span.shadow").stop(true).animate({opacity:0},300);var t=se?i.next():i.prev(),a=se?i.prev():i.next();if(i.hasClass("even")){a.find("span.shadow");a.find("span.shadow").stop(true).animate({opacity:0},300)}else{t.find("span.shadow");t.find("span.shadow").stop(true).animate({opacity:0},300)}});var K=P.position();n.find("div.showall-shadow-top, div.showall-shadow-bottom").width(P.width()).delay(500).animate({opacity:1},500);n.find("div.showall-shadow-top").css({top:K.top-12,left:K.left});n.find("div.showall-shadow-bottom").css({top:K.top+P.height()-39,left:K.left});P.find("div.show-all-thumb").on("click",function(){var i=e(this),t=Math.ceil(i.index());if(J&&!s.data().fauxCenter)Oe.click();if(t==0){t=1}if(V&&t<2)t=2;if(se){t=s.data().totalPages-t+1}s.trigger("mouseover");L(s);s.turn("page",t);q(t,s,n,"left");P.animate({opacity:0},300,function(){e(this).remove()});n.find("div.showall-shadow-bottom").animate({opacity:0},100,function(){e(this).remove()});n.find("div.showall-shadow-top").animate({opacity:0},100,function(){e(this).remove()});s.css("visibility","visible");s.stop(true).animate({opacity:1},300);if(J){Ee.css("visibility","visible");Ee.stop(true,true).animate({opacity:1},300)}T(s,n,"exit","show-all");if(t<2){s.find("div.fb-shadow-bottom-left").css("opacity",0);s.find("div.fb-shadow-top-left").css("opacity",0)}s.css("pointer-events","all");x.off("keydown",ne);ee=false});var U=P.find("div.content"),$=C-o*2+d,G=false;function ie(i,t){P.find("div.fb-page-content").slice(i,t).each(function(){var i=e(this).find(".bg-img:not(.img-loaded), img.lazy-load:not(.img-loaded)");i.each(function(){var i=e(this);i.attr("src",i.attr("data-src")).addClass("img-loaded").siblings(".bg-img-placeholder").remove()})})}var te=0,ae=c*g;ie(te,te+ae);n.find(".show-all-previous").on("click",function(){if(parseInt(U.css("top"))!=o&&!G){te-=ae;G=true;U.stop(true).animate({top:Math.min(parseInt(U.css("top"))+$,o)},1e3,"easeOutExpo",function(){G=false})}});n.find(".show-all-next").on("click",function(){if(parseInt(U.css("top"))-$>12-U.height()&&!G){te+=ae;ie(te,te+ae);G=true;U.stop(true).animate({top:parseInt(U.css("top"))-$},1e3,"easeOutExpo",function(){G=false})}});P.addSwipeEvents().on("swipeup",function(e,i){n.find(".show-all-next").trigger("click")}).addSwipeEvents().on("swipedown",function(e,i){n.find(".show-all-previous").trigger("click")}).on("touchmove",function(e){e.preventDefault()});function ne(e){if(e.keyCode==38){n.find(".show-all-previous").trigger("click");e.preventDefault()}else if(e.keyCode==40){n.find(".show-all-next").trigger("click");e.preventDefault()}else if(e.keyCode==27){r.find(".show-all-close").trigger("click");e.preventDefault()}}x.on("keydown",ne);r.find(".show-all-close").on("click",function(){P.animate({opacity:0},300,function(){e(this).remove()});n.find("div.showall-shadow-bottom").animate({opacity:0},100,function(){e(this).remove()});n.find("div.showall-shadow-top").animate({opacity:0},100,function(){e(this).remove()});s.css("visibility","visible");s.animate({opacity:1},300);if(J){Ee.css("visibility","visible");Ee.stop(true,true).animate({opacity:1},300)}T(s,n,"exit","show-all");s.find("div.fb-shadow-bottom-left").css("opacity",0);s.find("div.fb-shadow-top-left").css("opacity",0);s.css("pointer-events","all");x.off("keydown",ne);ee=false})});if(r.hasClass("aside")&&!c){r.css({"margin-top":-(r.height()*.5)+"px"});if(r.hasClass("left")&&n.parent().is("#rfbwp_fullscreen"))r.css({left:-r.width()-80});else if(n.parent().is("#rfbwp_fullscreen"))r.css({left:n.width+r.width()+80})}n.find(".next").on("click",we);n.find(".preview").on("click",me);function we(e){if(K)return;if(w&&g=="left"){g="right";var i=s.turn("page");R(i,s,n,"left");return}W="right";s.trigger("mouseover");if(J){if(s.data().fauxCenter)if(s.turn("page")==s.data().totalPages)s.trigger("cover-back");else s.turn("next");else s.trigger("cover-front")}else{s.turn("next")}}function me(e){if(K)return;if(w&&g=="right"){g="left";var i=s.turn("page");R(i,s,n,"right");return}W="left";s.trigger("mouseover");if(J){if(s.data().fauxCenter)if(s.turn("page")==1)s.trigger("cover-front");else s.turn("previous");else s.trigger("cover-back")}else{s.turn("previous")}}function be(i){var t=i.find(".fb-nav").data("grouped"),a=i.find(".fb-nav").hasClass("consolidated");if(t)return false;var s=i.find(".main-nav"),n=i.find(".alternative-nav"),o=i.find("div.next"),d=i.find("div.preview"),f=i.find("div.show-next"),p=i.find("div.show-prev"),c=i.find("div.show-all-next"),h=i.find("div.show-all-previous");i.find(".fb-nav").addClass("consolidated");if(o.length&&d.length){var u='<li class="next'+(!l?" hidden":"")+'">'+o.html()+"</li>",v='<li class="preview'+(!l?" hidden":"")+'">'+d.html()+"</li>";o.addClass("_next").removeClass("next").hide();d.addClass("_preview").removeClass("preview").hide();if(!s.find("li.next, li.preview").length)s.prepend(v).append(u);s.find(".preview").on("click",me);s.find(".next").on("click",we)}if(f.length&&p.length){var g='<li class="big-side show-next">'+f.html()+"</li>",w='<li class="big-side show-previous">'+p.html()+"</li>";f.addClass("_show-next").removeClass("show-next").hide();p.addClass("_show-previous").removeClass("show-previous").hide();if(!n.find("li.show-next, li.show-previous").length)n.prepend(w).append(g)}if(c.length&&h.length){var m='<li class="big-next show-all-next">'+c.html()+"</li>",b='<li class="big-next show-all-previous">'+h.html()+"</li>";c.addClass("_show-all-next").removeClass("show-all-next").hide();h.addClass("_show-all-previous").removeClass("show-all-previous").hide();if(!n.find("li.show-all-next, li.show-all-previous").length)n.prepend(b).append(m)}var x=r.find("ul li[data-text]");if(x.length){var C=0;x.each(function(){var i=e(this);if(C<i.width())C=i.width()});i.find(".big-side, .big-next, .next, .preview").width(C).height(C).css("line-height",C+"px")}}function xe(i){var t=i.find(".fb-nav").data("grouped"),a=i.find(".fb-nav").hasClass("consolidated");if(t)return false;if(!a)return false;var s=i.find(".main-nav"),n=i.find(".alternative-nav"),o=i.find("._next"),d=i.find("._preview"),f=i.find("._show-next"),l=i.find("._show-previous"),p=i.find("._show-all-next"),c=i.find("._show-all-previous");i.find(".fb-nav").removeClass("consolidated");if(o.length&&d.length){var h=i.find(".next"),u=i.find(".preview");h.remove();u.remove();o.addClass("next").removeClass("_next").show();d.addClass("preview").removeClass("_preview").show();o.find(".preview").on("click",me);d.find(".next").on("click",we)}if(f.length&&l.length){var v=i.find(".show-next"),g=i.find(".show-previous");v.remove();g.remove();f.addClass("show-next").removeClass("_show-next").show();l.addClass("show-previous").removeClass("_show-previous").show()}if(p.length&&c.length){var w=i.find(".show-all-next"),m=i.find(".show-all-previous");w.remove();m.remove();p.addClass("show-all-next").removeClass("_show-all-next").show();c.addClass("show-all-previous").removeClass("_show-all-previous").show()}var b=r.find("ul li[data-text]");if(b.length){var x=0;b.each(function(){var i=e(this);if(x<i.width())x=i.width()});i.find(".big-side, .big-next, .next, .preview").width(x).height(x).css("line-height",x+"px")}}function Ce(e,i){if(!c)s.turn("updateOptions",{cornerSize:100});if(e==1){if(i=="open"){Ee.removeClass("rfbwp-left rfbwp-right");Ee.addClass("rfbwp-both");setTimeout(function(){Oe.addClass("rfbwp-side-right").removeClass("rfbwp-side-left")},150)}else{Ee.removeClass("rfbwp-left rfbwp-both rfbwp-right");Ee.addClass("rfbwp-left");s.turn("updateOptions",{cornerSize:1});setTimeout(function(){Oe.addClass("rfbwp-side-left").removeClass("rfbwp-side-right")},150)}}else if(e==s.data().totalPages){if(i=="open"){Ee.removeClass("rfbwp-left rfbwp-right");Ee.addClass("rfbwp-both");setTimeout(function(){Me.addClass("rfbwp-side-left").removeClass("rfbwp-side-right")},150)}else{Ee.removeClass("rfbwp-left rfbwp-both");Ee.addClass("rfbwp-right");s.turn("updateOptions",{cornerSize:1});setTimeout(function(){Me.addClass("rfbwp-side-right").removeClass("rfbwp-side-left")},150)}}else{Ee.removeClass("rfbwp-left rfbwp-right");Ee.addClass("rfbwp-both")}}function ye(e){if(e==1){n.attr("data-display","front")}else if(e==s.data().totalPages){n.attr("data-display","back")}else{n.attr("data-display","inside")}}function ke(i){Te=e(this);We=Te.parent().is(".rfbwp-front")?"front":"back";if(Te[0]==Oe[0]&&s.turn("page")!=1)return;if(Te[0]==Me[0]&&s.turn("page")!=s.data().totalPages)return;if(Te[0]==Oe[0]&&s.data().fauxCenter)x.trigger("rfbwp-disable-corners");if(Te[0]==Me[0]&&s.data().fauxCenter)x.trigger("rfbwp-disable-corners");He=i.clientX;if(s.data().fauxCenter){if(Te[0]==Oe[0]){n.find(".preview").stop(true,true).animate({opacity:0}).css("display","none")}else{n.find(".next").stop(true,true).animate({opacity:0}).css("display","none")}}x.one("mouseup",Ie);x.on("mousemove",ze)}function ze(e){Fe=(e.clientX-He)*.25;if(Te.is(".rfbwp-active"))Fe-=180;if(Fe>0)Fe=0;if(Fe<-180)Fe=-180;if(Fe/90<-1)Te.addClass("rfbwp-side-right").removeClass("rfbwp-side-left");else Te.addClass("rfbwp-side-left").removeClass("rfbwp-side-right");Te.css("transform","rotateY("+Fe+"deg)")}function Ie(e){Te.css("transform","");Te.addClass("rfbwp-anim");if(Te[0]==Oe[0]&&s.data().fauxCenter)x.trigger("rfbwp-update-corners");if(Te[0]==Me[0]&&s.data().fauxCenter)x.trigger("rfbwp-update-corners");if(Te.is(".rfbwp-active")||Te.is(".rfbwp-back:not(.rfbwp-active)")){if(Fe>-90)s.trigger("cover-"+We)}else{if(Fe<-90)s.trigger("cover-"+We)}setTimeout(function(){Te.removeClass("rfbwp-anim")},300);if(s.data().fauxCenter){if(Te[0]==Oe[0]){n.find(".preview").stop(true,true).css("display","inline-block").animate({opacity:1})}else{n.find(".next").stop(true,true).css("display","inline-block").animate({opacity:1})}}x.off("mousemove",ze)}function _e(){if(Se)return;if(s.turn("page")==1){Se=true;Oe.addClass("rfbwp-anim");if(Oe.is(".rfbwp-active")){Ce(s.turn("page"),"close");s.data().fauxCenter=false;s.trigger("faux-turning",[1])}else{Ce(s.turn("page"),"open");s.data().fauxCenter=true;s.trigger("faux-turning",[2])}setTimeout(function(){Se=false;Oe.removeClass("rfbwp-anim")},600);Oe.toggleClass("rfbwp-active")}}function Pe(){if(Se)return;if(s.turn("page")==s.data().totalPages){Se=true;Me.addClass("rfbwp-anim");if(!Me.is(".rfbwp-active")){Ce(s.turn("page"),"close");s.data().fauxCenter=false;s.trigger("faux-turning",[s.data().totalPages])}else{Ce(s.turn("page"),"open");s.data().fauxCenter=true;s.trigger("faux-turning",[s.data().totalPages-2])}setTimeout(function(){Se=false;Me.removeClass("rfbwp-anim")},600);Me.toggleClass("rfbwp-active").trigger("back-cover-turned")}}var Ee=n.find(".rfbwp-cover-wrap"),Oe=n.find(".rfbwp-front .rfbwp-cover"),Me=n.find(".rfbwp-back .rfbwp-cover"),Se,Te,He,Fe,We;if(Ee.length){J=true;Ee.addClass("rfbwp-left");if(s.turn("page")==s.data().totalPages){Ee.addClass("rfbwp-right").removeClass("rfbwp-left");Me.addClass("rfbwp-active")}Y(s,n,r,Ee);x.on("resize",function(){Y(s,n,r,Ee)});if(V){Ce(3,"open");ye(3);s.data().fauxCenter=true}else{ye(s.turn("page"))}if(s.turn("page")==s.data().totalPages)Me.addClass("rfbwp-side-right");else Me.addClass("rfbwp-side-left");if(s.turn("page")==1)Oe.addClass("rfbwp-side-left");else Oe.addClass("rfbwp-side-right");s.on("cover-front",_e);s.on("cover-back",Pe);Oe.on("click",_e);Me.on("click",Pe);s.on("turning",function(e,i){Se=true;if(i!=1&&i!=s.data().totalPages)ye(i)});s.on("turned",function(e,i){Se=false;ye(i)});Oe.on("dragstart",function(e){e.preventDefault()});Me.on("dragstart",function(e){e.preventDefault()});Oe.on("mousedown",ke);Me.on("mousedown",ke);s.on("pressed",function(){n.attr("data-display","inside")});s.on("released",function(){if(s.turn("page")==1){n.attr("data-display","front")}else if(s.turn("page")==s.data().totalPages){n.attr("data-display","back")}})}O(s);E(s,n);u=parseInt(s.attr("data-fb-w"))*2;v=parseInt(s.attr("data-fb-h"));s.find("div.fb-page-content .page-html *:not(.no-scale), div.fb-page-content .mpc-numeration-wrap span").each(function(){var i=e(this);if(i.is("img"))i.data("_scale",{width:i.attr("width")?parseInt(i.attr("width")):parseInt(i.width()),"margin-top":parseInt(i.css("margin-top")),"margin-right":parseInt(i.css("margin-right")),"margin-bottom":parseInt(i.css("margin-bottom")),"margin-left":parseInt(i.css("margin-left")),"padding-top":parseInt(i.css("padding-top")),"padding-right":parseInt(i.css("padding-right")),"padding-bottom":parseInt(i.css("padding-bottom")),"padding-left":parseInt(i.css("padding-left"))});else if(i.parent().hasClass("mpc-numeration-wrap"))i.data("_scale",{"font-size":parseInt(i.css("font-size")),"line-height":parseInt(i.css("line-height")),"margin-top":parseInt(i.css("margin-top")),"margin-right":parseInt(i.css("margin-right")),"margin-bottom":parseInt(i.css("margin-bottom")),"margin-left":parseInt(i.css("margin-left")),"padding-top":parseInt(i.css("padding-top")),"padding-right":parseInt(i.css("padding-right")),"padding-bottom":parseInt(i.css("padding-bottom")),"padding-left":parseInt(i.css("padding-left")),"border-width":parseInt(i.css("border-width")),"border-radius":parseInt(i.css("border-radius"))});else{var t=parseInt(i.css("font-size")),a=i.css("line-height");if(a.indexOf("px")==-1)a*=t;i.data("_scale",{"font-size":t,"line-height":parseInt(a)})}});s.find("div.fb-page-content .page-html .rfbwp-page-link").on("click",function(i){i.preventDefault();var t=e(this),a=parseInt(t[0].hash.replace("#",""),10);if(!isNaN(a)){a=Math.min(s.data().totalPages,Math.max(a,0));s.turn("page",a)}});s.on("turned",function(e,i,t){P(s);return false});s.on("turning",function(e,i){var t=i%2?"left":"right";if(w)R(i,s,n,t)});function De(i,t){var a=t-t%2,n=s.find(".turn-page-wrapper"),o=n.slice(Math.max(0,a-3),Math.min(s.data().totalPages,a+3)),d=o.find(".bg-img:not(.zoom-large, .img-loaded), img.lazy-load:not(.img-loaded)");if(d.length){d.each(function(){var i=e(this);i.attr("src",i.attr("data-src")).addClass("img-loaded").siblings(".bg-img-placeholder").remove()})}if(n.find(".bg-img.bg-img-loaded").length==n.length){s.off("turning",De)}}s.on("turning",De);De(null,s.data().page);s.find("div.turn-page-wrapper.even").addSwipeEvents().on("swipeleft",function(e,i){if(w){g="right";var t=s.turn("page");R(t,s,n,"left")}});s.find("div.turn-page-wrapper.odd").addSwipeEvents().on("swiperight",function(e,i){if(w){g="left";var t=s.turn("page");R(t,s,n,"right")}});s.on("rfbwp.close",function(){if(n.find("div.show-all").length){n.find(".alternative-nav .show-all-close").trigger("click")}W="left";s.children("div.fb-shadow-top-right").animate({opacity:0},200).addClass("_fb-shadow-top-right").removeClass("fb-shadow-top-right");s.children("div.fb-shadow-bottom-right").animate({opacity:0},200).addClass("_fb-shadow-bottom-right").removeClass("fb-shadow-bottom-right");s.children("div.fb-shadow-top-left").animate({opacity:0},200).addClass("_fb-shadow-top-left").removeClass("fb-shadow-top-left");s.children("div.fb-shadow-bottom-left").animate({opacity:0},200).addClass("_fb-shadow-bottom-left").removeClass("fb-shadow-bottom-left");var e=0;if(J){if(!s.data().fauxCenter){if(s.turn("page")==s.data().totalPages){e+=1600;s.trigger("cover-back");setTimeout(function(){n.attr("data-display","inside");s.one("turned",function(){s.trigger("cover-front")});s.turn("page",1)},500)}}else if(s.data().fauxCenter){if(s.turn("page")==1){e+=500;s.trigger("cover-front")}else{e+=1100;n.attr("data-display","inside");s.one("turned",function(){s.trigger("cover-front")});s.turn("page",1)}}}else{if(s.turn("page")==s.data().totalPages){e+=1200;s.trigger("mouseover");s.turn("previous");s.one("turned",function(){W="left";s.trigger("mouseover");s.turn("page",1)})}else if(s.turn("page")!=1){e+=600;s.turn("page",1)}}setTimeout(function(){x.trigger("rfbwp.closed");s.children("div._fb-shadow-top-right").addClass("fb-shadow-top-right").removeClass("_fb-shadow-top-right");s.children("div._fb-shadow-bottom-right").addClass("fb-shadow-bottom-right").removeClass("_fb-shadow-bottom-right");s.children("div._fb-shadow-top-left").addClass("fb-shadow-top-left").removeClass("_fb-shadow-top-left");s.children("div._fb-shadow-bottom-left").addClass("fb-shadow-bottom-left").removeClass("_fb-shadow-bottom-left")},e);if(H)-x.trigger("closeZoom")});x.on("rfbwp.resize resize",function(){var i=e(this),t=s.turn("page"),a=i.width(),o=n.find("div.next"),d=n.find("div.preview"),f,p,h,g,m,b,y,k,I=parseInt(r.css("top"))+r.outerHeight()+40,_=s.outerHeight()+I,P=s.position(),E=n.parent().is("#rfbwp_fullscreen, .rfbwp-shelf-wrap, .rfbwp-popup-wrap");if(a<=768){c=true;l=false;o.hide();d.hide();s.turn("updateOptions",{cornerSize:1});n.css("overflow","hidden")}else{c=false;if(s.turn("page")==1&&J)s.turn("updateOptions",{cornerSize:1});else s.turn("updateOptions",{cornerSize:100});n.css("overflow","");if(!s.is(".no-arrows")&&!H){l=true;o.show();d.show()}}a<=1024?be(n):xe(n);var O=r.hasClass("top")?r.height():"0";O=r.hasClass("spread")?O+30:O;o.css("margin-top",O);d.css("margin-top",O);if(E&&c&&a>x.height()){r.find("li").css({"margin-bottom":r.find("li").css("margin-right")});r.removeClass("bottom").addClass("aside").removeClass("_aside")}else if(r.hasClass("_aside"))r.addClass("bottom").removeClass("aside").addClass("_aside").css({"margin-top":"","margin-bottom":""});else if(r.hasClass("aside")&&c)r.removeClass("aside").addClass("mobile-aside");else if(!c&&r.hasClass("mobile-aside"))r.removeClass("mobile-aside").addClass("aside");k=r.is(".aside")?0:r.outerHeight()+(r.is(".spread")?20:0);p=u;h=v;g=n.width()-(J?20:0);m=n.parent().height()-k-(J?20:0);b=x.height()-k-(J?20:0);if(m>b||!E)m=b;if(p>g){var M=g/p;p=p*M>>0;h=h*M>>0}w=false;if(p*1.25<u&&g<600){w=true;p=p*2;h=h*2}if(h>m){f=p/h;p=m*f>>0;h=m>>0}if(p%2==1)p-=1;if(c&&p<u*.5){r.find("ul li.zoom").css("display","none")}else{r.find("ul li.zoom").css("display","block")}if(c){r.find("ul li.fullscreen").remove()}if(E&&h<=z.height()){var S=(b-h-60+(J?20:0))*.5-(c?10:0);if(r.hasClass("top"))r.css("margin-top",S);else s.css("margin-top",S);if(C.is(".ie9")){n.find("div.preview, div.next").css("top",h*.5+S);if(J)Y(s,n,r,Ee)}}else{if(r.hasClass("top"))r.css("margin-top",0);else s.css("margin-top",0)}if(p!=s.width()||h!=s.height())N(p,h,s,n,H,v);y=s.height()/v;j(s,y);var T=0;if((t==1||t==s.data().totalPages)&&!s.data().fauxCenter){T=Math.floor((n.width()-s.width()*.5)*.5);if(t==1)T-=s.width()*.5}else{T=Math.floor((n.width()-s.width())*.5)}if(parseInt(s.css("left"))!=T)s.css("left",T);if(H){if(s.turn("page")==1||w)T+=p*.25;else if(s.turn("page")==s.data().totalPages)T-=p*.25;n.children("div.zoomed").css({left:T});n.children("div.zoomed-shadow, div.zoomed-shadow-bottom, div.zoomed-shadow-top").css({left:T})}q(t,s,n,W)});x.on("keydown",function(i){if(ee||ie)return;if(i.keyCode==37){if(K)return;if(H){var t=n.find(".big-side.show-previous");if(!t.is(":hidden")){t.click()}}else{me(null)}}else if(i.keyCode==39){if(K)return;if(H){var a=n.find(".big-side.show-next");if(!a.is(":hidden")){a.click()}}else{we(null)}}else if(i.keyCode==27){s.css({visibility:"visible","pointer-events":"all"});if(J)Ee.css("visibility","visible").stop(true).animate({opacity:1},300);s.stop(true).animate({opacity:1},300,function(){M("turned","false",s,n,"zoom")});n.find("div.zoomed").animate({opacity:0},300,function(){e(this).remove();H=false;r.find("ul li.zoom").trigger("mouseout")});T(s,n,"exit","zoom");T(s,n,"exit","show-all");n.find("div.zoomed-shadow").stop(true).animate({opacity:0},300,function(){e(this).remove()});n.find("div.zoomed-shadow-bottom").stop(true).animate({opacity:0},100,function(){e(this).remove()});n.find("div.zoomed-shadow-top").stop(true).animate({opacity:0},100,function(){e(this).remove()});n.find("div.show-all").stop(true).animate({opacity:0},300,function(){e(this).remove()});n.find("div.showall-shadow-bottom").stop(true).animate({opacity:0},100,function(){e(this).remove()});n.find("div.showall-shadow-top").stop(true).animate({opacity:0},100,function(){e(this).remove()})}}).on("hashchange",function(){E(s,n)}).on("touchstart",function(e){var i=e.originalEvent.touches;if(i[0])touchStart={x:i[0].pageX,y:i[0].pageY};touchEnd=null}).on("touchmove",function(e){var i=e.originalEvent.touches,t=s.offset();if(i[0].pageX>t.left&&i[0].pageY>t.top&&i[0].pageX<t.left+s.width()&&i[0].pageY<t.top+s.height()){if(i[0])touchEnd={x:i[0].pageX,y:i[0].pageY}}}).on("touchend",function(i){if(J&&!s.data().fauxCenter)return;if(window.touchStart&&window.touchEnd&&e(i.target).closest(".flipbook-container")[0]==n[0]){var t=s.width()*.5,a={x:touchEnd.x-touchStart.x,y:touchEnd.y-touchStart.y},o={x:touchStart.x-s.offset().left,y:touchStart.y-s.offset().top};if(Math.abs(a.y)<100){if(K)return;if(a.x>100&&o.x<t){s.turn("previous")}else if(a.x<-100&&o.x>t){s.turn("next")}else if(J&&a.x>100&&o.x>t&&s.data().fauxCenter){s.trigger("cover-front")}else if(J&&a.x<-100&&o.x<t&&s.data().fauxCenter){s.trigger("cover-back")}}}}).on("start",function(e,i){if(p){s.find("div.fpage object").css({display:"none"});s.find("div.video object").css({display:"none"})}else{s.find("div.fpage object").css({opacity:0})}M("start",W,s,n,"start");Q=true}).on("end",function(e){if(p){s.find("div.fpage object").css({display:"block"});s.find("div.video object").css({display:"block"})}else{s.find("div.fpage object").css({opacity:1})}M("turned","false",s,n,"end");Q=false;limiter=0});x.on("rfbwp.refocus-flipbook",function(){if(_rfbwp_focused_flipbook!=s[0].id)ie=true;else ie=false});n.on("mousedown mouseenter",function(){if(_rfbwp_focused_flipbook!=s[0].id){_rfbwp_focused_flipbook=s[0].id;x.trigger("rfbwp.refocus-flipbook")}});e(".flipbook-container").first().trigger("mouseenter");N(u,v,s,n,H,v);A(s,n)}X(s)}s();e(window).on("rfbwp.shelf rfbwp.popup",s);e(window).on("rfbwp.init",a)})(jQuery);var _rfbwp_focused_flipbook;